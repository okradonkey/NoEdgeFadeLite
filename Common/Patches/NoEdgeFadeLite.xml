<?xml version="1.0" encoding="utf-8" ?>
<Patch>

  <!-- ========== Patch - OkraDonkey.NoEdgeFadeLite ========== -->
  <!-- Targeting Core\Defs\TerrainDefs\Terrain_Floors.xml -->
  <!-- Targeting Core\Defs\TerrainDefs\Terrain_Floors_Burned.xml -->
  <!-- Targeting Core\Defs\TerrainDefs\Terrain_Floors_StoneTile.xml -->
  <!-- Targeting Core\Defs\TerrainDefs\Terrain_Natural.xml -->
  <!-- Targeting Core\Defs\TerrainDefs\Terrain_Road.xml -->
  <!-- Targeting Core\Defs\TerrainDefs\Terrain_Water.xml -->

  <Operation Class="PatchOperationSequence">
    <success>Always</success>
      <operations>

        <!-- change renderPrecendence: generally, render man-made floors above natural terrains -->
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "BurnedWoodPlankFloor"]/renderPrecedence</xpath>    <value><renderPrecedence>391</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "WoodPlankFloor"]/renderPrecedence</xpath>          <value><renderPrecedence>390</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "SterileTile"]/renderPrecedence</xpath>             <value><renderPrecedence>383</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "GoldTile"]/renderPrecedence</xpath>                <value><renderPrecedence>382</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "SilverTile"]/renderPrecedence</xpath>              <value><renderPrecedence>381</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "MetalTile"]/renderPrecedence</xpath>               <value><renderPrecedence>380</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "PavedTile"]/renderPrecedence</xpath>               <value><renderPrecedence>370</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[@Name = "FlagstoneBase"]/renderPrecedence</xpath>             <value><renderPrecedence>360</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[@Name = "TileStoneBase"]/renderPrecedence</xpath>             <value><renderPrecedence>360</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Concrete"]/renderPrecedence</xpath>                <value><renderPrecedence>355</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "BurnedCarpet"]/renderPrecedence</xpath>            <value><renderPrecedence>340</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "CarpetRed"]/renderPrecedence</xpath>               <value><renderPrecedence>339</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "CarpetGreen"]/renderPrecedence</xpath>             <value><renderPrecedence>338</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "CarpetBlue"]/renderPrecedence</xpath>              <value><renderPrecedence>337</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "CarpetCream"]/renderPrecedence</xpath>             <value><renderPrecedence>336</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "CarpetDark"]/renderPrecedence</xpath>              <value><renderPrecedence>335</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "WaterMovingChestDeep"]/renderPrecedence</xpath>    <value><renderPrecedence>299</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "WaterMovingShallow"]/renderPrecedence</xpath>      <value><renderPrecedence>298</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "WaterOceanDeep"]/renderPrecedence</xpath>          <value><renderPrecedence>297</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "WaterOceanShallow"]/renderPrecedence</xpath>       <value><renderPrecedence>296</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "WaterDeep"]/renderPrecedence</xpath>               <value><renderPrecedence>295</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "WaterShallow"]/renderPrecedence</xpath>            <value><renderPrecedence>294</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "BrokenAsphalt"]/renderPrecedence</xpath>           <value><renderPrecedence>270</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "PackedDirt"]/renderPrecedence</xpath>              <value><renderPrecedence>260</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "SoftSand"]/renderPrecedence</xpath>                <value><renderPrecedence>252</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Ice"]/renderPrecedence</xpath>                     <value><renderPrecedence>250</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Sand"]/renderPrecedence</xpath>                    <value><renderPrecedence>250</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Soil"]/renderPrecedence</xpath>                    <value><renderPrecedence>240</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "MarshyTerrain"]/renderPrecedence</xpath>           <value><renderPrecedence>237</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "SoilRich"]/renderPrecedence</xpath>                <value><renderPrecedence>235</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Mud"]/renderPrecedence</xpath>                     <value><renderPrecedence>230</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Marsh"]/renderPrecedence</xpath>                   <value><renderPrecedence>225</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Gravel"]/renderPrecedence</xpath>                  <value><renderPrecedence>220</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "MossyTerrain"]/renderPrecedence</xpath>            <value><renderPrecedence>215</renderPrecedence></value></li>

        <!-- change edgeType to Hard to match the new look -->
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "BurnedWoodPlankFloor"]/edgeType</xpath><value><edgeType>Hard</edgeType></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "BurnedCarpet"]/edgeType</xpath><value><edgeType>Hard</edgeType></value></li>

      </operations>
  </Operation>

  <!-- ========== Patch for the original [RF] Fertile Fields [1.0] ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>[RF] Fertile Fields [1.0]</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "BrickFloor"]/renderPrecedence</xpath>              <value><renderPrecedence>355</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "HBBrickFloor"]/renderPrecedence</xpath>            <value><renderPrecedence>355</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Topsoil"]/renderPrecedence</xpath>                 <value><renderPrecedence>240</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "DirtFert"]/renderPrecedence</xpath>                <value><renderPrecedence>235</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "SoilTilled"]/renderPrecedence</xpath>              <value><renderPrecedence>233</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "RockySoil"]/renderPrecedence</xpath>               <value><renderPrecedence>220</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

    <!-- ========== Patch for jamaicancastle.RF.fertilefields ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Fertile Fields [1.1]</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "BrickFloor"]/renderPrecedence</xpath>              <value><renderPrecedence>355</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "HBBrickFloor"]/renderPrecedence</xpath>            <value><renderPrecedence>355</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "Topsoil"]/renderPrecedence</xpath>                 <value><renderPrecedence>240</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "DirtFert"]/renderPrecedence</xpath>                <value><renderPrecedence>235</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "SoilTilled"]/renderPrecedence</xpath>              <value><renderPrecedence>233</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "TrenchDeep"]/renderPrecedence</xpath>              <value><renderPrecedence>228</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "TrenchMuddy"]/renderPrecedence</xpath>             <value><renderPrecedence>226</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "TrenchShallow"]/renderPrecedence</xpath>           <value><renderPrecedence>225</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "RockySoil"]/renderPrecedence</xpath>               <value><renderPrecedence>220</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "SoilWorn"]/renderPrecedence</xpath>                <value><renderPrecedence>200</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for Telkir.TMods.MoreFloors ========== -->
  <!-- Includes patch of abstract FloorBaseStone for floors added by MoreFloors patches -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>[T] MoreFloors</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationAdd"><xpath>Defs/TerrainDef[@Name = "TFloorBaseGemstone"]/renderPrecedence</xpath>          <value><renderPrecedence>384</renderPrecedence></value></li>
        <li Class="PatchOperationAdd"><xpath>Defs/TerrainDef[@Name = "FloorBaseStone"]/renderPrecedence</xpath>              <value><renderPrecedence>368</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[@Name = "TFloorBaseCarpet"]/renderPrecedence</xpath>        <value><renderPrecedence>334</renderPrecedence></value></li>

        <li Class="PatchOperationRemove"><xpath>Defs/TerrainDef[defName = "FloorStoneMosaicSandstone"]/renderPrecedence</xpath></li>

        <li Class="PatchOperationAdd"><xpath>Defs/TerrainDef[defName = "FloorPlasteel"]/renderPrecedence</xpath>             <value><renderPrecedence>385</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "FloorWoodRustic"]/renderPrecedence</xpath>       <value><renderPrecedence>350</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "FloorWoodWide"]/renderPrecedence</xpath>         <value><renderPrecedence>349</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "FloorWoodLight"]/renderPrecedence</xpath>        <value><renderPrecedence>348</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "FloorWoodMosaic"]/renderPrecedence</xpath>       <value><renderPrecedence>347</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "FloorWoodVertical"]/renderPrecedence</xpath>     <value><renderPrecedence>346</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "FloorWoodBarn"]/renderPrecedence</xpath>         <value><renderPrecedence>345</renderPrecedence></value></li>
        <li Class="PatchOperationAdd"><xpath>Defs/TerrainDef[defName = "BurnedStrawFloor"]/renderPrecedence</xpath>          <value><renderPrecedence>255</renderPrecedence></value></li>
        <li Class="PatchOperationAdd"><xpath>Defs/TerrainDef[defName = "FloorStraw"]/renderPrecedence</xpath>                <value><renderPrecedence>254</renderPrecedence></value></li>

        <!-- change edgeType to Hard to match the new look -->
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "FloorWoodBarn"]/edgeType</xpath><value><edgeType>Hard</edgeType></value></li>

      </operations>
    </match>
  </Operation>

    <!-- ========== Patch for RadZerp.naturalPaths ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Natural Paths</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[@Name = "pathBase"]/renderPrecedence</xpath>                  <value><renderPrecedence>250</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "gravelPath"]/renderPrecedence</xpath>              <value><renderPrecedence>251</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "gravelPathLight"]/renderPrecedence</xpath>         <value><renderPrecedence>251</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "sandPath"]/renderPrecedence</xpath>                <value><renderPrecedence>249</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for fluffy.stuffedfloors ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Stuffed Floors</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace">
            <xpath>Defs/StuffedFloors.FloorTypeDef[@Name = "StuffedFloorsBase"]/renderPrecedence</xpath>                       <value><renderPrecedence>301</renderPrecedence></value>
        </li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for FrozenSnowFox.CarpetsoftheRainbow ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>[FSF] Carpets of the Rainbow</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>/Defs/TerrainDef[@ParentName = "FSFCarpetBase"]/renderPrecedence</xpath>      <value><renderPrecedence>300</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for essecoisa.FlooredYASTO ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Floored - Yellow and Striped Tiles Only [1.0+]</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "StripedTile"]/renderPrecedence</xpath>             <value><renderPrecedence>380</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "YellowTile"]/renderPrecedence</xpath>              <value><renderPrecedence>380</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for essecoisa.Floored ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Floored [1.0+]</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "StripedTile"]/renderPrecedence</xpath>             <value><renderPrecedence>380</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "YellowTile"]/renderPrecedence</xpath>              <value><renderPrecedence>380</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "PlasteelTile"]/renderPrecedence</xpath>            <value><renderPrecedence>380</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for essecoisa.CautionTiles ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Caution Tiles [1.0+]</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[
          defName = "YellowStripedTile" or
          defName = "RedStripedTile" or
          defName = "BlueStripedTile" or
          defName = "GreenStripedTile" or
          defName = "PurpleTileStripedTile" or
          defName = "YellowStripedTileNE" or
          defName = "RedStripedTileNE" or
          defName = "BlueStripedTileNE" or
          defName = "GreenStripedTileNE" or
          defName = "PurpleTileStripedTileNE" or
          defName = "YellowStripedTileSE" or
          defName = "RedStripedTileSE" or
          defName = "BlueStripedTileSE" or
          defName = "GreenStripedTileSE" or
          defName = "PurpleTileStripedTileSE" or
          defName = "YellowStripedTileSW" or
          defName = "RedStripedTileSW" or
          defName = "BlueStripedTileSW" or
          defName = "GreenStripedTileSW" or
          defName = "PurpleTileStripedTileSW" or
          defName = "YellowTile" or
          defName = "RedTile" or
          defName = "BlueTile" or
          defName = "GreenTile" or
          defName = "PurpleTile"
          ]/renderPrecedence</xpath><value><renderPrecedence>380</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for spdskatr.projectrimfactory ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>Project RimFactory Revived</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "StripedTile"]/renderPrecedence</xpath>             <value><renderPrecedence>380</renderPrecedence></value></li>
        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[defName = "StripedTileLeft"]/renderPrecedence</xpath>         <value><renderPrecedence>380</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

  <!-- ========== Patch for dismarzero.VGP.VGPGardenTools ========== -->
  <Operation Class="PatchOperationFindMod">
    <mods>
      <li>VGP Garden Tools</li>
    </mods>
    <match Class="PatchOperationSequence">
      <success>Always</success>
      <operations>

        <li Class="PatchOperationReplace"><xpath>Defs/TerrainDef[
          defName = "VG_PlaceSoil" or
          defName = "VG_ReclaimSoil" or
          defName = "VG_ReclaimMud" or
          defName = "VG_ReclaimWater" or
          defName = "VG_GardenSoil" or
          defName = "VG_PlowSoil"
          ]/renderPrecedence</xpath><value><renderPrecedence>235</renderPrecedence></value></li>

      </operations>
    </match>
  </Operation>

</Patch>
